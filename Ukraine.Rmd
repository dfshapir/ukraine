---
title: "Ukraine"
author: "Daniel Shapiro"
date: "4/16/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
options(scipen=999)
library(tidyverse)
library(readr)
library(readxl)
library(cowplot)
```

```{r}
Totals <- read_xlsx("Totals.xlsx")
```

```{r pct graph}
pct <- Totals %>%
  mutate(`No Mask` = `No Mask`/`Total` * 100) %>%
  mutate(`Mask Covers Nothing` = `Mask Covers Nothing`/`Total` * 100) %>%
  mutate(`Mask Covers Mouth` = `Mask Covers Mouth`/`Total` * 100) %>%
  mutate(`Full Mask` = `Full Mask`/`Total` * 100)

pct <- pivot_longer(pct, cols = c(`No Mask`, `Mask Covers Nothing`, `Mask Covers Mouth`, `Full Mask`)) %>%
  rename(Percentage = value) %>%
  rename(`Level of Adherence` = name)

region <- ggplot(pct, aes(x = Region, y = Percentage, fill = `Level of Adherence`)) +
  geom_col() +
  coord_flip() +
  scale_fill_manual(values = c("light green", "yellow", "orange", "red")) +
  labs(title = "Mask Wearing By Region")

region

ggsave("region.png")
```

```{r hdi}
City <- read_xlsx("City Data.xlsx")
```

```{r hdireal}
City <- City %>%

# Filter to get only full mask
  
  filter(Category == "Full Mask") %>%

# Multiply HDI by 100 for readability purposes
  
  mutate(`2019 Oblast HDI` = `2019 Oblast HDI` * 100)
```

```{r regression}
hdireg <- lm(Percentage ~ `2019 Oblast HDI` + `2020 City Population` + `Total Ukr Cases` + `Not Oblast Center`, data = City)

summary(hdireg)
```

